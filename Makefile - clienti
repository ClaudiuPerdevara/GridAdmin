# --- SETARI COMPILATOR ---
CC = gcc
# Flag-uri pentru erori si optimizare
WARN_FLAGS = -Wall -Wextra
# Flag-uri specifice pentru GTK (Interfata Grafica)
GTK_FLAGS = $(shell pkg-config --cflags gtk+-3.0)
GTK_LIBS = $(shell pkg-config --libs gtk+-3.0)
# Flag-uri pentru Crypto (OpenSSL)
SSL_LIBS = -lssl -lcrypto

# --- TINTA PRINCIPALA (Compilare) ---
all: client

client: client.c
	@echo "Se compileaza Clientul..."
	$(CC) $(WARN_FLAGS) $(GTK_FLAGS) -o client client.c $(GTK_LIBS) $(SSL_LIBS)
	@echo "GATA! Ruleaza cu: ./client <IP> <PORT> <PASS>"

# --- TINTA DE INSTALARE DEPENDINTE (Magia) ---
setup:
	@echo "Se verifica si instaleaza dependintele necesare..."
	@echo "   (Va cere parola de sudo pentru instalare)"
	
	@# Comanda pentru Debian / Ubuntu / Linux Mint / Kali
	@if command -v apt-get >/dev/null; then \
		sudo apt-get update; \
		sudo apt-get install -y build-essential libgtk-3-dev libssl-dev pkg-config; \
	# Comanda pentru Fedora / RedHat / CentOS
	elif command -v dnf >/dev/null; then \
		sudo dnf install -y gcc gtk3-devel openssl-devel pkgconf; \
	# Comanda pentru Arch Linux / Manjaro
	elif command -v pacman >/dev/null; then \
		sudo pacman -S --noconfirm base-devel gtk3 openssl; \
	else \
		echo "Eroare: Nu am recunoscut managerul de pachete. Instaleaza manual GTK3 si OpenSSL."; \
		exit 1; \
	fi
	@echo "Dependinte instalate cu succes!"

# --- CURATARE ---
clean:
	rm -f client
	@echo "Curatenie facuta."
